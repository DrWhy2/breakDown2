<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Describing Explanations • iBreakDown</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="../dalexverse.css" rel="stylesheet">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../dalexverse-2.css" rel="stylesheet">
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Describing Explanations">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- google analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-5650686-14"></script><script>
 window.dataLayer = window.dataLayer || [];
 function gtag(){dataLayer.push(arguments);}
 gtag('js', new Date());

 gtag('config', 'UA-5650686-14');
</script>
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>

      <div class="navbar-brand-container">
      <a class="navbar-mi2logo" href="http://DrWhy.AI/">
    <img src="https://github.com/ModelOriented/DrWhyTemplate/blob/master/inst/pkgdown/assets/drwhy_znak_violet_small.jpg?raw=true" alt="MI2" height="46" title="MI2"></a>
        <a class="navbar-brand" href="../index.html">iBreakDown</a>
        <div class="info">
          <span class="partof">part of the <a href="https://github.com/ModelOriented/DrWhy">DrWhy.AI</a>
           developed by the <a href="https://mi2.mini.pw.edu.pl/">MI^2 DataLab</a> </span>
          <span class="version version-default">0.9.9</span>
        </div>
      </div>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav navbar-right">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/vignette_iBreakDown_classification.html">iBreakDown plots for classification models</a>
    </li>
    <li>
      <a href="../articles/vignette_iBreakDown_description.html">Describing Explanations</a>
    </li>
    <li>
      <a href="../articles/vignette_iBreakDown_regression.html">iBreakDown plots for regression models</a>
    </li>
    <li>
      <a href="../articles/vignette_iBreakDown_titanic.html">iBreakDown plots for Sinking of the RMS Titanic</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
        
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Describing Explanations</h1>
            
      
      
      <div class="hidden name"><code>vignette_iBreakDown_description.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level2">
<h2 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h2>
<p>We adress the problem of insuficient interpretability of explanations for domain experts. We solve this issue by introducing <code><a href="../reference/describe.html">describe()</a></code> function, which automaticly generates natural language descriptions of explanations generated with <code>iBrakDown</code> package.</p>
</div>
<div id="ibreakdown-package" class="section level2">
<h2 class="hasAnchor">
<a href="#ibreakdown-package" class="anchor"></a>iBreakDown Package</h2>
<p>The <code>iBreakDown</code> package allows for generating feature attribution explanations. Feature attribution explanations justify a model’s prediction by showing which of the model’s variables affect the prediction and to what extent. It is done by attaching to each variable an importance coefficient, which sum should approximate the model’s prediction.</p>
<p>There are two methods used by <code>iBreakDown</code> package: <code><a href="../reference/break_down_uncertainty.html">shap()</a></code> and <code><a href="../reference/break_down.html">break_down()</a></code>.</p>
<p>Function <code><a href="../reference/break_down_uncertainty.html">shap()</a></code> generates a SHAP explanation, that is the function assigns Shapley values to each variable. Function <code>break_down</code> uses break_down algorithm to generate an efficient approximation of the Shapley values. We show how to generate both explanations on an easy example using titanic data set and explainers from <code>DALEX</code> package.</p>
<p>First, we load the data set and build a random forest model classifying, which of the passangers survived sinking of the titanic. Then, using <code>DALEX</code> package, we generate an explainer of the model. Lastly we select a random passanger, which prediction’s should be explained.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="st">"DALEX"</span>)</a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="st">"iBreakDown"</span>)</a>
<a class="sourceLine" id="cb1-3" data-line-number="3"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="st">"randomForest"</span>)</a>
<a class="sourceLine" id="cb1-4" data-line-number="4">titanic &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/na.fail.html">na.omit</a></span>(titanic)</a>
<a class="sourceLine" id="cb1-5" data-line-number="5"></a>
<a class="sourceLine" id="cb1-6" data-line-number="6">model_titanic_rf &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/randomForest/man/randomForest.html">randomForest</a></span>(survived <span class="op">==</span><span class="st"> "yes"</span> <span class="op">~</span><span class="st"> </span>.,</a>
<a class="sourceLine" id="cb1-7" data-line-number="7">                                 <span class="dt">data =</span> titanic </a>
<a class="sourceLine" id="cb1-8" data-line-number="8">                                 )</a>
<a class="sourceLine" id="cb1-9" data-line-number="9"></a>
<a class="sourceLine" id="cb1-10" data-line-number="10">explain_titanic_rf &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/pkg/DALEX/man/explain.html">explain</a></span>(model_titanic_rf,</a>
<a class="sourceLine" id="cb1-11" data-line-number="11">                            <span class="dt">data =</span> titanic[,<span class="op">-</span><span class="dv">9</span>],</a>
<a class="sourceLine" id="cb1-12" data-line-number="12">                            <span class="dt">y =</span> titanic<span class="op">$</span>survived <span class="op">==</span><span class="st"> "yes"</span>,</a>
<a class="sourceLine" id="cb1-13" data-line-number="13">                            <span class="dt">label =</span> <span class="st">"Random Forest"</span>)</a>
<a class="sourceLine" id="cb1-14" data-line-number="14"></a>
<a class="sourceLine" id="cb1-15" data-line-number="15">passanger &lt;-<span class="st"> </span>titanic[<span class="kw"><a href="https://rdrr.io/r/base/sample.html">sample</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span>(titanic), <span class="dv">1</span>) ,<span class="op">-</span><span class="dv">9</span>]</a>
<a class="sourceLine" id="cb1-16" data-line-number="16">passanger</a></code></pre></div>
<pre><code>#&gt;      gender age            class    embarked country fare sibsp parch
#&gt; 1609   male  36 victualling crew Southampton England    0     0     0</code></pre>
<p>Now we are ready for generating <code><a href="../reference/break_down_uncertainty.html">shap()</a></code> and <code>iBreakDown()</code> explanations.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1">bd_rf &lt;-<span class="st"> </span><span class="kw"><a href="../reference/break_down.html">break_down</a></span>(explain_titanic_rf,</a>
<a class="sourceLine" id="cb3-2" data-line-number="2">                    passanger,</a>
<a class="sourceLine" id="cb3-3" data-line-number="3">                    <span class="dt">keep_distributions =</span> <span class="ot">TRUE</span>) <span class="co"># distributions should be kept</span></a>
<a class="sourceLine" id="cb3-4" data-line-number="4">shap_rf &lt;-<span class="st"> </span><span class="kw"><a href="../reference/break_down_uncertainty.html">shap</a></span>(explain_titanic_rf,</a>
<a class="sourceLine" id="cb3-5" data-line-number="5">                passanger)</a>
<a class="sourceLine" id="cb3-6" data-line-number="6"></a>
<a class="sourceLine" id="cb3-7" data-line-number="7"><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(bd_rf)</a></code></pre></div>
<p><img src="vignette_iBreakDown_description_files/figure-html/unnamed-chunk-3-1.png" width="672"></p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(shap_rf)</a></code></pre></div>
<p><img src="vignette_iBreakDown_description_files/figure-html/unnamed-chunk-3-2.png" width="672"></p>
</div>
<div id="describing-an-explanation" class="section level2">
<h2 class="hasAnchor">
<a href="#describing-an-explanation" class="anchor"></a>Describing an explanation</h2>
<p>The displayed explanations despite their visual clarity may not be interpretable for someone not familiar with iBreakDown or shap explanation. Therefore, we generate a simple natural language description for both explainers.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="kw"><a href="../reference/describe.html">describe</a></span>(bd_rf)</a></code></pre></div>
<pre><code>#&gt; Random Forest predicts, that the prediction for the selected instance is 0.159 which is lower than the average model prediction. For the selected instance model's prediction is lower, than for 65% of all observations.
#&gt; 
#&gt; The most important variable that decrease the prediction is gender.
#&gt; 
#&gt; Other variables are with less importance. The contribution of all other variables is 0.005.</code></pre>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="kw"><a href="../reference/describe.html">describe</a></span>(shap_rf)</a></code></pre></div>
<pre><code>#&gt; Random Forest predicts, that the prediction for the selected instance is 0.159 which is lower than the average model prediction. For the selected instance model's prediction is lower, than for 65% of all observations.
#&gt; 
#&gt; The most important variable that decrease the prediction is gender.
#&gt; 
#&gt; Other variables are with less importance. The contribution of all other variables is 0.004.</code></pre>
</div>
<div id="parameters-of-describe-function" class="section level2">
<h2 class="hasAnchor">
<a href="#parameters-of-describe-function" class="anchor"></a>Parameters of describe() function</h2>
<p>Natural language descriptions should be flexible enough to generate a description with a desired level of specificity and lenght. We describe the parameters used for describing both explanations. As both explanatios have the same parameters, we turn our attention to describe the iBreakDown explanation.</p>
<div id="adjusting-nonsignificance-treshold" class="section level4">
<h4 class="hasAnchor">
<a href="#adjusting-nonsignificance-treshold" class="anchor"></a>Adjusting nonsignificance treshold</h4>
<p>The nonsignificance treshold controls which predictions are close to the average prediction. By setting a higher value, more predictions will be described as close to the average model prediction and more variables will be described as nonsignificant.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1"><span class="kw"><a href="../reference/describe.html">describe</a></span>(bd_rf, <span class="dt">nonsignificance_treshold =</span> <span class="dv">1</span>)</a></code></pre></div>
<pre><code>#&gt; Random Forest predicts, that the prediction for the selected instance is 0.159 which is close to the average model prediction. For the selected instance model's prediction is lower, than for 65% of all observations.
#&gt; 
#&gt; The most important variable that decrease the prediction is gender.
#&gt; 
#&gt; Other variables are with less importance. The contribution of all other variables is 0.005.</code></pre>
</div>
<div id="adjusting-label-of-the-explanation" class="section level4">
<h4 class="hasAnchor">
<a href="#adjusting-label-of-the-explanation" class="anchor"></a>Adjusting label of the explanation</h4>
<p>Label of the prediction could be changed, to display more specific descriptions.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1"><span class="kw"><a href="../reference/describe.html">describe</a></span>(bd_rf, </a>
<a class="sourceLine" id="cb11-2" data-line-number="2">         <span class="dt">label =</span> <span class="st">"the passanger survived with probability"</span>)</a></code></pre></div>
<pre><code>#&gt; Random Forest predicts, that the passanger survived with probability 0.159 which is lower than the average model prediction. For the selected instance model's prediction is lower, than for 65% of all observations.
#&gt; 
#&gt; The most important variable that decrease the prediction is gender.
#&gt; 
#&gt; Other variables are with less importance. The contribution of all other variables is 0.005.</code></pre>
</div>
<div id="short-descriptions" class="section level4">
<h4 class="hasAnchor">
<a href="#short-descriptions" class="anchor"></a>Short descriptions</h4>
<p>Generating short descriptions can be useful, as they can make nice plot subtitles.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1"><span class="kw"><a href="../reference/describe.html">describe</a></span>(bd_rf, <span class="dt">short_description =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>#&gt; Random Forest predicts, that the prediction for the selected instance is 0.159. The most important variable, which decreases model's prediction, is gender.</code></pre>
</div>
<div id="displaying-values" class="section level4">
<h4 class="hasAnchor">
<a href="#displaying-values" class="anchor"></a>Displaying values</h4>
<p>Displaying variable values can easily make the description more informative.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" data-line-number="1"><span class="kw"><a href="../reference/describe.html">describe</a></span>(bd_rf, <span class="dt">display_values =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>#&gt; Random Forest predicts, that the prediction for the selected instance is 0.159 which is lower than the average model prediction. For the selected instance model's prediction is lower, than for 65% of all observations.
#&gt; 
#&gt; The most important variable that decrease the prediction is gender (= male).
#&gt; 
#&gt; Other variables are with less importance. The contribution of all other variables is 0.005.</code></pre>
</div>
<div id="displaying-numbers" class="section level4">
<h4 class="hasAnchor">
<a href="#displaying-numbers" class="anchor"></a>Displaying numbers</h4>
<p>Displaying numbers changes the whole argumentation style making the description longer.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" data-line-number="1"><span class="kw"><a href="../reference/describe.html">describe</a></span>(bd_rf, <span class="dt">display_numbers =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>#&gt; Random Forest predicts, that the prediction for the selected instance is 0.159 which is lower than the average model prediction 0.324. For the selected instance model's prediction is lower, than for 65% of all observations.
#&gt; 
#&gt; The most important variable is gender. It decreases the prediction by 0.1.
#&gt; The second most important variable is country. It decreases the prediction by 0.038.
#&gt; The third most important variable is age. It decreases the prediction by 0.032.
#&gt; 
#&gt; Other variables are with less importance. The contribution of all other variables is 0.005.</code></pre>
</div>
<div id="distribution-details" class="section level4">
<h4 class="hasAnchor">
<a href="#distribution-details" class="anchor"></a>Distribution details</h4>
<p>Describing distribution details is useful if we want to have a big picture about other instance’s behaviour.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" data-line-number="1"><span class="kw"><a href="../reference/describe.html">describe</a></span>(bd_rf, <span class="dt">display_distribution_details =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>#&gt; Random Forest predicts, that the prediction for the selected instance is 0.159 which is lower than the average model prediction.Model predictions range from 0.006 to 0.992. The distribution of Random Forest's predictions is right-skewed with average equal to 0.324 and median equal to 0.213. The standard deviation is 0.281. Model's prediction for the selected instance is in the second quartile.
#&gt; 
#&gt; The most important variable that decrease the prediction is gender.
#&gt; 
#&gt; Other variables are with less importance. The contribution of all other variables is 0.005.</code></pre>
</div>
<div id="shap" class="section level4">
<h4 class="hasAnchor">
<a href="#shap" class="anchor"></a>SHAP</h4>
<p>Explanations generated by <code><a href="../reference/break_down_uncertainty.html">shap()</a></code> functions have the same arguments expect from <code>display_shap</code> what add an addition information, wheter the calculated variable’s contributions have high or low variability.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" data-line-number="1"><span class="kw"><a href="../reference/describe.html">describe</a></span>(shap_rf, <span class="dt">display_shap =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>#&gt; Random Forest predicts, that the prediction for the selected instance is 0.159 which is lower than the average model prediction. For the selected instance model's prediction is lower, than for 65% of all observations.
#&gt; 
#&gt; The most important variable that decrease the prediction is gender.
#&gt; The average contribution of all the above variables is significant.
#&gt; 
#&gt; Other variables are with less importance. The contribution of all other variables is 0.004.</code></pre>
</div>
<div id="combibning-all-the-parameters" class="section level4">
<h4 class="hasAnchor">
<a href="#combibning-all-the-parameters" class="anchor"></a>Combibning all the parameters</h4>
<p>Of course all the arguments can be set according to preferences allowing for flexible natural language descriptions.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" data-line-number="1"><span class="kw"><a href="../reference/describe.html">describe</a></span>(shap_rf,</a>
<a class="sourceLine" id="cb23-2" data-line-number="2">         <span class="dt">label =</span> <span class="st">"the passanger survived with probability"</span>,</a>
<a class="sourceLine" id="cb23-3" data-line-number="3">         <span class="dt">display_values =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb23-4" data-line-number="4">         <span class="dt">display_numbers =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb23-5" data-line-number="5">         <span class="dt">display_shap =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>#&gt; Random Forest predicts, that the passanger survived with probability 0.159 which is lower than the average model prediction 0.324. For the selected instance model's prediction is lower, than for 65% of all observations.
#&gt; 
#&gt; The most important variable is gender (= male). It decreases the prediction by 0.113.
#&gt; The second most important variable is age (= 36). It decreases the prediction by 0.03.
#&gt; The third most important variable is class (= victualling crew). It decreases the prediction by 0.027.
#&gt; The average contribution of all the above variables is significant.
#&gt; 
#&gt; Other variables are with less importance. The contribution of all other variables is 0.004.</code></pre>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#introduction">Introduction</a></li>
      <li><a href="#ibreakdown-package">iBreakDown Package</a></li>
      <li><a href="#describing-an-explanation">Describing an explanation</a></li>
      <li><a href="#parameters-of-describe-function">Parameters of describe() function</a></li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="author">
  <p>
    Developed by Przemyslaw Biecek, Alicja Gosiewska, Hubert Baniecki, Adam Izdebski.
    Site built by <a href="https://pkgdown.r-lib.org">pkgdown</a>.
  </p>
</div>

      </footer>
</div>

  


  </body>
</html>
