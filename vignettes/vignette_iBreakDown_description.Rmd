---
title: "vignette_iBreakDown_description"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{vignette_iBreakDown_description}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

# Introduction

The goal of explaining a model's prediction is to relate the feature values of an instance to its model prediction in an understandable way.

In `iBreakDown` package we can explain a model by generating
a ` break_down()` explanation - it shows contributions of variables to the prediction made by the model - or a ` break_down_uncertainty()` / `shap()` explanation - shows the average contribution of variables to the prediction made by the model. It is generated by iterating the break_down algorithm. 

These tools, however extremely useful, in some context may lack interpretability e.g. when a domain expert is unable to interpret the more or less complicated plots being displayed. 

Generic `describe()` function generates natural language description for the above mentioned methods increasing their interpretability, thus usability, what is crucial for xAI methods. 
 

# How to generate natural language descriptions

First we load all the packages.

```{r setup, warning = FALSE, message = FALSE}
 library("DALEX")
 library("iBreakDown")
```

We generate a model to be explained based on the titanic dataset and we generate a `DALEX` explainer for it.

```{r}
titanic <- na.omit(titanic)
model_titanic_glm <- glm(titanic$survived == "yes" ~ age + gender + class + fare + sibsp,
                        data = titanic[ ,-9], family = "binomial")
explain_titanic_glm <- explain(model_titanic_glm,
                            data = titanic[,-9],
                            y = titanic$survived == "yes",
                            label = "glm")
```
Now we randomly select a passanger and generate a `break_down` description. We keep the distributions to display more informative descriptions. Unfortunatelly, interactions are not supported yet. 
```{r}
passanger <- titanic[sample(nrow(titanic), 1) ,-9]
bd_glm <- break_down(explain_titanic_glm, passanger,
                     keep_distributions = TRUE)

plot(bd_glm)
```
We explain the model with `break_down()` function. The picture that emerges is not complex but it lacks a clear narration. We can describe the plot by calling `describe()`.

```{r}
describe(bd_glm,
         label = "the selected passanger survives with probability")
```

If we want to generate a similar description for a shap explainer it is simple.
```{r}
shap_glm <- shap(explain_titanic_glm, passanger)
plot(shap_glm)
```
We set `display_numbers = TRUE` for a more detailed explanation and `display_shap = TRUE` for displaying details about shap explainer. 
```{r}
describe(shap_glm,
         label = "the selected passanger survives with probability",
         display_shap = TRUE,
         display_numbers = T)
```
